

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Compute Scaling &mdash; terraform-iac-lab  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Summary" href="../05-summary/summary.html" />
    <link rel="prev" title="Dynamic Address Groups" href="dag.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> terraform-iac-lab
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../00-overview/introduction.html">Introduction</a></li>
</ul>
<p class="caption"><span class="caption-text">getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../01-getting-started/requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01-getting-started/setup.html">Setup</a></li>
</ul>
<p class="caption"><span class="caption-text">build</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../02-build/deploy-gcp.html">Lab Deployment (GCP)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02-build/deploy-aws.html">Lab Deployment (AWS)</a></li>
</ul>
<p class="caption"><span class="caption-text">run</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../03-run/terraform/background-terraform.html">Terraform Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03-run/terraform/activities-terraform.html">Terraform Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03-run/ansible/background-ansible.html">Ansible Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03-run/ansible/activities-ansible.html">Ansible Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03-run/validation.html">Validation Testing</a></li>
</ul>
<p class="caption"><span class="caption-text">respond</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="monitor.html">Cloud Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="dag.html">Dynamic Address Groups</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Compute Scaling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#determine-dynamic-address-group-membership">Determine Dynamic Address Group membership</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scale-out-the-database-instances">Scale out the database instances</a></li>
<li class="toctree-l2"><a class="reference internal" href="#confirm-dynamic-address-group-changes">Confirm Dynamic Address Group changes</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">summary</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../05-summary/summary.html">Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05-summary/comparison.html">Tool Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05-summary/cleanup.html">Cleaning Up</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05-summary/moreinfo.html">Further Reading</a></li>
</ul>
<p class="caption"><span class="caption-text">appendix</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../06-appendix/terraform-commit.html">Terraform and Commits</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">terraform-iac-lab</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Compute Scaling</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/04-respond/scale-out.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="compute-scaling">
<h1>Compute Scaling<a class="headerlink" href="#compute-scaling" title="Permalink to this headline">¶</a></h1>
<p>In this activity you will:</p>
<ul class="simple">
<li>Determine Dynamic Address Group membership</li>
<li>Scale out the database instances</li>
<li>Confirm Dynamic Address Group changes</li>
</ul>
<p>The combination of VM Information Sources and Dynamic Address Groups allows the firewall to respond to changes made to the cloud environment.  In this lab scenario you will scale out the number of database instances used to support the web application.  This should result in the automatic update of the Dynamic Address Group membership.</p>
<div class="section" id="determine-dynamic-address-group-membership">
<h2>Determine Dynamic Address Group membership<a class="headerlink" href="#determine-dynamic-address-group-membership" title="Permalink to this headline">¶</a></h2>
<p>First, we should confirm that the one database instance we’ve already deployed has already been mapped to the Dynamic Address Group based on it’s <code class="docutils literal notranslate"><span class="pre">server-type</span></code> attribute.</p>
<p>Navigate to <strong>Objects &gt; Address Groups</strong> in the firewall web interface and select the Dynamic Address Group <code class="docutils literal notranslate"><span class="pre">db-grp</span></code> that you previously created.</p>
<p>Under the <em>Addresses</em> column, click on the link entitled <code class="docutils literal notranslate"><span class="pre">more...</span></code></p>
<div class="figure align-center">
<img alt="../_images/before.png" src="../_images/before.png" />
</div>
<p>You should see the IP address <code class="docutils literal notranslate"><span class="pre">10.5.3.5</span></code>, which is the IP address of the existing database instance.</p>
<p>Click <strong>Close</strong> to close the pop-up window.</p>
</div>
<div class="section" id="scale-out-the-database-instances">
<h2>Scale out the database instances<a class="headerlink" href="#scale-out-the-database-instances" title="Permalink to this headline">¶</a></h2>
<p>To scale out the number of database instances we’ll go back to our Terraform deployment.</p>
<p>For GCP:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> ~/multicloud-automation-lab/deployment/gcp
</pre></div>
</div>
<p>For AWS:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> ~/multicloud-automation-lab/deployment/aws
</pre></div>
</div>
<p>In the <code class="docutils literal notranslate"><span class="pre">main.tf</span></code> file there is a module called <code class="docutils literal notranslate"><span class="pre">scale</span></code> that is commented out.  Open <code class="docutils literal notranslate"><span class="pre">main.tf</span></code> in a text editor and uncomment that entire section.</p>
<p>Save the file and exit.</p>
<p>By uncommenting the <code class="docutils literal notranslate"><span class="pre">scale</span></code> module you have just added a new module to the Terraform plan.  This will require a re-initialization of the plan.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ terraform init
</pre></div>
</div>
<p>You can now apply the Terraform plan.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ terraform apply
</pre></div>
</div>
<p>This will result in four new database instances being added to the database subnet.</p>
</div>
<div class="section" id="confirm-dynamic-address-group-changes">
<h2>Confirm Dynamic Address Group changes<a class="headerlink" href="#confirm-dynamic-address-group-changes" title="Permalink to this headline">¶</a></h2>
<p>Now go back to the <strong>Objects &gt; Address Groups</strong> section of the firewall web interface and click <code class="docutils literal notranslate"><span class="pre">more...</span></code> under the <strong>Addresses</strong> column of the <code class="docutils literal notranslate"><span class="pre">db-grp</span></code> entry.</p>
<div class="figure align-center">
<img alt="../_images/after.png" src="../_images/after.png" />
</div>
<p>You should now see a total of five IP addresses as members of the <code class="docutils literal notranslate"><span class="pre">db-grp</span></code> Dynamic Address Group.  These are now part of the destination match criteria for the databaase security rule.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Remember that the VM Information Source is polling the cloud provider API every <em>60 seconds</em>.  If you do not see a total of five IP addresses in the Dynamic Address Group, close the window and click on <code class="docutils literal notranslate"><span class="pre">more...</span></code> again after a few moments.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../05-summary/summary.html" class="btn btn-neutral float-right" title="Summary" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="dag.html" class="btn btn-neutral float-left" title="Dynamic Address Groups" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Palo Alto Networks

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>